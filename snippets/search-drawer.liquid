{{ 'search-drawer.css' | asset_url | stylesheet_tag: preload: true }}

{% assign keywords = section.settings.search_keywords | split: ',' %}

<div
  id="js-search-drawer"
  class="shopify-section-search noksha-drawer"
  data-open-section="search-drawer"
>
  <div class="inner-section drawer-space">

    <div class="serch-box">
      <form action="/search" method="get" role="search">
        <input
          type="search"
          id="SearchDrawerInput"
          name="q"
          placeholder="Search..."
          autocomplete="off"
          aria-label="Search"
        >
        <button type="submit">Search</button>
      </form>
    </div>

    <div class="search-suggestions">
      <h4>Suggested Searches</h4>
      <ul
        id="SearchSuggestionList"
        data-keywords='[
          {% for word in keywords %}
            "{{ word | strip | escape }}"{% unless forloop.last %},{% endunless %}
          {% endfor %}
        ]'
      ></ul>
    </div>

  </div>
</div>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const input = document.getElementById("SearchDrawerInput");
  const list = document.getElementById("SearchSuggestionList");

  if (!input || !list) return;

  const keywords = JSON.parse(list.dataset.keywords);

  function renderSuggestions(query = "") {
    list.innerHTML = "";

    const results = keywords
      .filter(word =>
        word.toLowerCase().includes(query.toLowerCase())
      )
      .slice(0, 5);

    results.forEach(word => {
      const li = document.createElement("li");
      li.innerHTML = `
        <a href="/search?q=${encodeURIComponent(word)}">
          ${word}
        </a>
      `;
      list.appendChild(li);
    });
  }

  // Initial render (first 5)
  renderSuggestions();

  // Filter on typing
  input.addEventListener("input", e => {
    renderSuggestions(e.target.value.trim());
  });
});
</script>

{% render 'section-base-style' %}

{% liquid
  assign first_class = 'timeline-section ' | append: 'm-color-' | append: section.settings.color_scheme 
  assign first_class = first_class | append: ' ' | append: section.settings.color_control
  assign first_class = first_class | append: ' ' | append: section.settings.custom_class
  assign first_class = first_class | append: ' ' | append: 'section-' | append: section.id | append: '-padding'
  assign container_width = section.settings.container_width
%}

<div class="{{ first_class }}" id="timeline-{{ section.id }}">
  <div class="{{ container_width }}">

    {% if section.settings.heading != blank %}
      <div class="section-title text-{{ section.settings.text_align }}">
        <h2 class="{{ section.settings.title_size }}">
          {{ section.settings.heading }}
        </h2>

        {% if section.settings.subheading != blank %}
          <div class="section-description">
            {{ section.settings.subheading }}
          </div>
        {% endif %}
      </div>
    {% endif %}

    {% if section.blocks.size > 0 %}
      <div class="timeline-container">

        {% for block in section.blocks %}
          <div class="timeline-item timeline-item-{{ block.settings.position }}" {{ block.shopify_attributes }}>
            
            <div class="timeline-content">

              {% if block.settings.date != blank %}
                <div class="timeline-date">
                  {{ block.settings.date }}
                </div>
              {% endif %}

              <div class="icon-wrapper">

                {% if block.settings.icon != blank %}
                  <div class="timeline-icon">
                    {% render 'theme-icon', icon: block.settings.icon %}
                  </div>
                {% endif %}

                {% if block.settings.title != blank %}
                  <div class="timeline-title">
                    {{ block.settings.title }}
                  </div>
                {% endif %}

              </div>

              {% if block.settings.description != blank %}
                <div class="timeline-description">
                  {{ block.settings.description }}
                </div>
              {% endif %}

            </div>

          </div>
        {% endfor %}

      </div>
    {% endif %}

  </div>
</div>


{% stylesheet %}

.timeline-section {
  position: relative;
}

.timeline-section .section-title {
  margin-bottom: 40px;
}

.timeline-section .timeline-container {
  position: relative;
  max-width: 1000px;
  margin: 0 auto;
}

/* Center Line */
.timeline-section .timeline-container::after {
  content: '';
  position: absolute;
  width: 6px;
  background-color: rgb(var(--color-border));
  top: 0;
  bottom: 0;
  left: 50%;
  margin-left: -3px;
  border-radius: 3px;
}

/* Timeline Item */
.timeline-section .timeline-item {
  padding: 10px 40px;
  position: relative;
  width: 50%;
}

/* Circle */
.timeline-section .timeline-item::after {
  content: '';
  position: absolute;
  width: 22px;
  height: 22px;
  right: -11px;
  background-color: rgb(var(--color-background));
  border: 4px solid rgb(var(--color-border));
  top: 22px;
  border-radius: 50%;
  z-index: 1;
}

/* Left */
.timeline-section .timeline-item-left {
  left: 0;
}

/* Right */
.timeline-section .timeline-item-right {
  left: 50%;
}

.timeline-section .timeline-item-right::after {
  left: -11px;
}

/* Card */
.timeline-section .timeline-content {
  padding: 20px 30px;
  background-color: rgb(var(--color-background));
  border-radius: 10px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.05);
}

.timeline-section .timeline-date {
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 10px;
  opacity: .8;
}

.timeline-section .icon-wrapper {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
}

.timeline-section .timeline-icon svg {
  width: 20px;
  height: 20px;
}

.timeline-section .timeline-title {
  font-size: 18px;
  font-weight: 600;
}

.timeline-section .timeline-description {
  font-size: 14px;
  opacity: .85;
}

/* Mobile */
@media (max-width: 768px) {

  .timeline-section .timeline-container::after {
    left: 31px;
  }

  .timeline-section .timeline-item {
    width: 100%;
    padding-left: 70px;
    padding-right: 25px;
  }

  .timeline-section .timeline-item::after {
    left: 19px;
  }

  .timeline-section .timeline-item-right {
    left: 0;
  }
}

{% endstylesheet %}


{% schema %}
{
  "name": "Timeline",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Our Journey"
    },
    {
      "type": "richtext",
      "id": "subheading",
      "label": "Section Description",
      "default": "<p>The story of your brand through the years</p>"
    },
    {
      "type": "select",
      "id": "title_size",
      "label": "Heading Size",
      "options": [
        { "value": "h1", "label": "H1" },
        { "value": "h2", "label": "H2" },
        { "value": "h3", "label": "H3" },
        { "value": "h4", "label": "H4" }
      ],
      "default": "h2"
    },
    {
      "type": "select",
      "id": "text_align",
      "label": "Text Align",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },

    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme"
    },
    {
      "type": "select",
      "id": "container_width",
      "label": "Container width",
      "options": [
        { "value": "container", "label": "Container" },
        { "value": "container-fluid", "label": "Container fluid" },
        { "value": "container-narrow", "label": "Container narrow" },
        { "value": "container-extra-narrow", "label": "Container extra narrow" },
        { "value": "extended", "label": "Extended" }
      ],
      "default": "container"
    },
    {
      "type": "select",
      "id": "color_control",
      "label": "Color Control",
      "options": [
        { "value": "section-dark", "label": "Dark" },
        { "value": "section-light", "label": "Light" }
      ],
      "default": "section-light"
    },
    {
      "type": "text",
      "id": "custom_class",
      "label": "Custom class"
    },

    {
      "type": "header",
      "content": "Section Padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "Top padding",
      "default": 80
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding",
      "default": 80
    }
  ],

  "blocks": [
    {
      "type": "timeline_item",
      "name": "Timeline Item",
      "settings": [
        {
          "type": "select",
          "id": "position",
          "label": "Item Position",
          "options": [
            { "value": "left", "label": "Left" },
            { "value": "right", "label": "Right" }
          ],
          "default": "left"
        },
        {
          "type": "text",
          "id": "date",
          "label": "Date",
          "default": "January 2020"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Milestone Title"
        },
        {
          "type": "text",
          "id": "icon",
          "label": "Theme Icon Name",
          "info": "Use icon name from your theme-icon snippet (example: store, award, globe, heart)"
        },
        {
          "type": "richtext",
          "id": "description",
          "label": "Description",
          "default": "<p>Add milestone description here.</p>"
        }
      ]
    }
  ],

  "presets": [
    {
      "name": "Timeline",
      "blocks": [
        { "type": "timeline_item" },
        { "type": "timeline_item" },
        { "type": "timeline_item" }
      ]
    }
  ]
}
{% endschema %}

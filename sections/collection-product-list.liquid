{{ 'collection-product-list.css' | asset_url | stylesheet_tag }}
{{ 'products-filter.css' | asset_url | stylesheet_tag }}

<div
  class="main-product-list m-color-{{ section.settings.product_color_scheme }} {{ section.settings.color_control }} {{ section.settings.custom_class }}"
  data-section-id="{{ section.id }}"
  data-enable-pagination="{{ section.settings.enable_pagination }}"
  data-pagination-type="{{ section.settings.pagination_type }}"
  data-products-per-page="{{ section.settings.products_per_page }}"
>

  <div class="{{ section.settings.container_type }}">
    <div class="collection-wrapper sidebar-space with-sidebar">

      <main class="inner-warpper">

        {% paginate collection.products by section.settings.products_per_page %}
          <div
            class="products-grid cols-{{ section.settings.grid_columns_desktop }}"
            id="productsContainer"
            data-total-products="{{ collection.products_count }}"
            data-total-pages="{{ paginate.pages }}"
            data-current-page="{{ paginate.current_page }}"
          >
            {% for product in collection.products %}
              {% render 'product-card', product: product %}
            {% endfor %}
          </div>
        {% endpaginate %}

        {% if section.settings.enable_pagination %}
          <div id="paginationWrapper" class="custom-pagination">

            {% if section.settings.pagination_type == 'pagination_by_number' %}
              <nav class="pagination-ui pagination-ui--numbers">
                <div class="pagination-numbers" data-pagination-numbers></div>
              </nav>

            {% elsif section.settings.pagination_type == 'load_more_button' %}
              <div class="pagination-ui pagination-ui--loadmore">
                <button type="button" id="loadMoreBtn">Load More</button>
                <div class="pagination-loader" data-loader hidden>Loading...</div>
              </div>

            {% elsif section.settings.pagination_type == 'infinity_loading' %}
              <div class="pagination-ui pagination-ui--infinity">
                <div class="pagination-loader" data-loader hidden>Loading...</div>
              </div>
            {% endif %}

          </div>
        {% endif %}

      </main>

      {% if section.settings.enable_filter %}
        <aside class="product-filter filters-wrapper">
          {% render 'product-filter', section: section, collection: collection %}
        </aside>
      {% endif %}

    </div>
  </div>
</div>

<script src="{{ 'product-filter.js' | asset_url }}" defer></script>
{% schema %}
{
  "name": "Collection Product List",
  "settings": [
    {
      "type": "select",
      "id": "container_type",
      "label": "Container Type",
      "options": [
        { "value": "container", "label": "Container" },
        { "value": "container-fluid", "label": "Container Fluid" },
        { "value": "full-width", "label": "Full Width" }
      ],
      "default": "container"
    },
    {
      "type": "color_scheme",
      "id": "product_color_scheme",
      "label": "Color Scheme",
      "default": "scheme-1"
    },
    {
      "type": "select",
      "id": "grid_columns_desktop",
      "label": "Desktop Grid Columns",
      "options": [
        { "value": "2", "label": "2" },
        { "value": "3", "label": "3" },
        { "value": "4", "label": "4" }
      ],
      "default": "4"
    },
    {
      "type": "checkbox",
      "id": "enable_pagination",
      "label": "Enable Pagination",
      "default": true
    },
    {
      "type": "range",
      "id": "products_per_page",
      "min": 2,
      "max": 48,
      "step": 1,
      "label": "Products per page",
      "default": 24
    },
    {
      "type": "select",
      "id": "pagination_type",
      "label": "Pagination Type",
      "options": [
        { "value": "pagination_by_number", "label": "Pagination by Number" },
        { "value": "load_more_button", "label": "Load More Button" },
        { "value": "infinity_loading", "label": "Infinity Loading" }
      ],
      "default": "pagination_by_number"
    },
    {
      "type": "checkbox",
      "id": "enable_filter",
      "label": "Enable Filter",
      "default": true
    },
    {
      "type": "text",
      "id": "custom_class",
      "label": "Custom class"
    },
    {
      "type": "select",
      "id": "color_control",
      "label": "Color Control",
      "options": [
        { "value": "section-dark", "label": "Dark" },
        { "value": "section-light", "label": "Light" }
      ],
      "default": "section-light"
    }
  ],
  "blocks": [
    {
      "type": "availability-filter",
      "name": "Availability Filter",
      "limit": 1
    },
    {
      "type": "vendor-filter",
      "name": "Vendor Filter",
      "limit": 1
    },
    {
      "type": "collection-filter",
      "name": "Collection Filter",
      "settings": [
        {
          "type": "link_list",
          "id": "collection_menu",
          "label": "Collection Menu"
        }
      ]
    },
    {
      "type": "color-filter",
      "name": "Color Filter",
      "limit": 1
    },
    {
      "type": "tag-filter",
      "name": "Tag Filter",
      "settings": [
        {
          "type": "text",
          "id": "filter_title",
          "label": "Title",
          "default": "Tags"
        },
        {
          "type": "text",
          "id": "custom_filter_tags",
          "label": "Allowed Tags"
        }
      ]
    },
    {
      "type": "price-filter",
      "name": "Price Filter",
      "limit": 1
    },
    {
      "type": "product-type-filter",
      "name": "Product Type Filter",
      "settings": [
        {
          "type": "text",
          "id": "product_types",
          "label": "Product Types"
        }
      ]
    },
    {
      "type": "size-filter",
      "name": "Size Filter"
    }
  ]
}
{% endschema %}

{% comment %}
  This section is used in the article template to render the article page, which
  displays the full content of the blog post and can optionally include a
  comments section for customers (not shown in this example).

  https://shopify.dev/docs/storefronts/themes/architecture/templates/article
{% endcomment %}
{% render 'section-base-style' %}
{% liquid
  assign ss = section.settings

  assign first_class = 'main-article ' | append: 'm-color-' | append: ss.color_scheme 
  assign first_class = first_class | append: ' ' | append: ss.color_control
  assign first_class = first_class | append: ' ' | append: ss.custom_class
  assign first_class = first_class | append: ' ' | append: 'section-' | append: section.id | append: '-padding'
  assign container_width = ss.container_width
  
  assign image_wapper_classes = 'cropped-image-wrapper cropped-image--landscape'
%}
<div class="{{ first_class }}" id="store-location-{{ section.id }}">
  <div class="article-header">
    {% if article.image %}
    <div class="article-image">
        {% render 'image',
          class: image_wapper_classes,
          image:  article.image,
          width: 1000,
          img_alt: article.title
        %}
    </div>
    <div class="article-info">
        {% render 'hero-info',
        heading: article.title,
        heading_tag: 'h1',
        heading_size: ss.font_size,
        text_align: ss.text_align,
        container_width: container_width
        %} 
      {% assign date = article.published_at | time_tag: format: 'date' %}
        <p>{{ 'blog.article_metadata_html' | t: date: date, author: article.author }}</p>
    </div>
    {% endif %}
  </div>
  <div class="{{ container_width }}">
    <div class="inner-section {% if ss.enable_sidebar_space %}sidebar-space{% endif %}">
      <div class="article-content">
        {{ article.content }}
      </div>
      <div class="article-comment">
      {% if blog.comments_enabled? %}
        <h2>{{ 'blog.article_comments' | t }}</h2>

        <div id="comments">
          {% paginate article.comments by 10 %}
            {% for comment in article.comments %}
              <div>
                <p>{{ comment.author }}</p>
                <p>
                  {{- comment.created_at | time_tag: format: 'date' -}}
                </p>
                <p>{{ comment.content }}</p>
              </div>
            {% endfor %}

            {{ paginate | default_pagination: anchor: 'comments' }}
          {% endpaginate %}
        </div>

        {% form 'new_comment', article %}
          <h2 class="sub-title">{{ 'blog.comment_form_title' | t }}</h2>

          {{ form.errors | default_errors }}

          <div>
            <label for="author">{{ 'blog.comment_form_name' | t }}</label>
            <input type="text" name="comment[author]" id="author" value="{{ form.author }}" required>
          </div>

          <div>
            <label for="email">{{ 'blog.comment_form_email' | t }}</label>
            <input type="email" name="comment[email]" id="email" value="{{ form.email }}" required>
          </div>

          <div>
            <label for="body">{{ 'blog.comment_form_body' | t }}</label>
            <textarea name="comment[body]" id="body" required>{{ form.body }}</textarea>
          </div>

          <input  type="submit" value="{{ 'blog.comment_form_submit' | t }}">
        {% endform %}
      {% endif %}

      </div>
    </div>
  </div>
</div>
{% stylesheet %}
.main-article{
  background: rgb(var(--color-background-secondary));
}
.article-header {
  margin-bottom: 1rem;
}
.article-image,
.article-info {
    margin-bottom: 1rem;
}
@media (max-width: 990px){
  .article-header {
    padding: 1rem;
  }
}
@media (min-width: 991px) {
.article-header {
    display: flex;
    width: 100%;
    height: 100%;
    gap: 2rem;
    margin-bottom: 3rem;
    align-items: center;
}
.article-image,
.article-info {
    width: 100%;
}
.article-info {
    position: relative;
    left: -10rem;
    background: rgb(var(--color-background));
    padding: 2rem;
}
}
{% endstylesheet %}

{% schema %}
{
  "name": "t:general.article",
  "settings": [
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "checkbox",
      "id": "enable_sidebar_space",
      "label": "Enable sidebar space",
      "default": true
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme"
    },
    {
      "type": "select",
      "id": "container_width",
      "label": "Container width",
      "options": [
        { "value": "container", "label": "Container" },
        { "value": "container-fluid", "label": "Container fluid" },
        { "value": "container-narrow", "label": "Container narrow" },
        { "value": "container-extra-narrow", "label": "Container extra narrow" },
        { "value": "full-width", "label": "Full width" },
        { "value": "extended", "label": "Extended" }
      ],
      "default": "extended"
    },
    {
      "type": "select",
      "id": "font_size",
      "label": "Font size",
      "info": "Blog title font size",
      "options": [
        { "value": "h1", "label": "h1" },
        { "value": "h2", "label": "h2" },
        { "value": "h3", "label": "h3" },
        { "value": "h4", "label": "h4" },
      ],
      "default": "h3"
    },
    {
      "type": "header",
      "content": "Section padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top padding",
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding",
      "default": 52
    },
    {
      "type": "text",
      "id": "custom_class",
      "label": "Custom class"
    },
    {
      "type": "select",
      "id": "color_control",
      "label": "Color Control",
      "options": [
        { "value": "section-dark", "label": "Dark" },
        { "value": "section-light", "label": "Light" }
      ],
      "default": "section-light"
    }
  ]
}
{% endschema %}

{% liquid
  assign first_class = 'login-page ' | append: 'm-color-' | append: settings.color_scheme 
  assign first_class = first_class | append: ' ' | append: settings.color_control
  assign first_class = first_class | append: ' ' | append: settings.custom_class

  assign container_width = settings.container_width
  assign recover_success = false
%}

<div id="customer-login-page" class="{{ first_class }}">
  <div class="{{ container_width }} container-wrapper">
    <div class="login-wrapper sidebar-space">

      <!-- LOGIN FORM -->
      <div data-login-form>
        <h2 class="h3">Sign in</h2>

        {% form 'customer_login' %}
          {{ form.errors | default_errors }}

          <div class="field">
            <label for="CustomerEmail">Email</label>
            <input
              type="email"
              name="customer[email]"
              id="CustomerEmail"
              placeholder="Enter your email"
              autocomplete="email"
              required
            >
          </div>

          <div class="field">
            <label for="CustomerPassword">Password</label>
            <input
              type="password"
              name="customer[password]"
              id="CustomerPassword"
              placeholder="Enter Password"
              autocomplete="current-password"
              required
            >
          </div>

          <button type="submit" class="button">
            Sign in
          </button>
        {% endform %}

        <p>
          <button type="button" class="recover-link" data-show-recover>
            Forgot password?
          </button>
        </p>

        <p class="customer-create-link">
          New customer?
          <a href="{{ routes.account_register_url }}">Create account</a>
        </p>
      </div>

      <!-- RECOVER FORM -->
      <div data-recover-form style="display:none;">
        <h2 class="h3">Reset password</h2>

        {% form 'recover_customer_password' %}

          {% if form.posted_successfully? %}
            {% assign recover_success = true %}
            <div class="form-success">
              <p>
                If an account exists for this email, youâ€™ll receive a password reset link shortly.
              </p>
            </div>
          {% endif %}

          {{ form.errors | default_errors }}

          <div class="field">
            <label for="RecoverEmail">Email</label>
            <input
              type="email"
              name="email"
              id="RecoverEmail"
              placeholder="Enter your email"
              autocomplete="email"
              required
            >
          </div>

          <button type="submit" class="button">
            Send reset link
          </button>

        {% endform %}

        <p>
          <button type="button" class="recover-link" data-hide-recover>
            Back to login
          </button>
        </p>
      </div>

    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const page = document.getElementById('customer-login-page');
    if (!page) return;

    const loginForm = page.querySelector('[data-login-form]');
    const recoverForm = page.querySelector('[data-recover-form]');
    if (!loginForm || !recoverForm) return;

    function showRecover() {
      loginForm.style.display = 'none';
      recoverForm.style.display = 'block';
    }

    function showLogin() {
      recoverForm.style.display = 'none';
      loginForm.style.display = 'block';
    }

    // Handle button clicks
    page.addEventListener('click', (e) => {
      if (e.target.closest('[data-show-recover]')) {
        e.preventDefault();
        showRecover();
        history.replaceState(null, '', '#recover');
      }

      if (e.target.closest('[data-hide-recover]')) {
        e.preventDefault();
        showLogin();
        history.replaceState(null, '', window.location.pathname);
      }
    });

    // ðŸ”¥ Handle direct link: /account/login#recover
    if (window.location.hash === '#recover') {
      showRecover();
    }

    // After successful submit, keep recover visible
    {% if recover_success %}
      showRecover();
    {% endif %}
  });
</script>




{% stylesheet %}
.login-page {
    padding: 6rem 0 3rem 0;
}
.login-page .container-wrapper{
    margin-left: 0;
}
.login-page .login-wrapper h2 {
    text-transform: uppercase;
    margin-bottom: 2rem;
}
.login-page form {
  max-width: 26rem;
}
.login-page .field {
    display: flex;
    flex-direction: column;
}
.login-page label {
    font-size: 0.9em;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: 600;
}
.login-page input {
    padding: .8rem 0;
    border-bottom: 2px solid rgb(var(--color-border));
    border-radius: 0;
    margin-bottom: 1.4rem;
}
.login-page .button {
    background: rgb(var(--color-heading));
    color: rgb(var(--color-background));
    border: 2px solid rgb(var(--color-heading));
    padding: 0.8rem 2rem;
    font-size: 0.9em;
    text-transform: uppercase;
    letter-spacing: 1.2px;
    margin-bottom: 1rem;
}
.login-page .button:hover {
    background: transparent;
    color: rgb(var(--color-heading));
}
.login-page .customer-create-link a {
  color: rgb(var(--color-border));
    border-bottom: 1px solid rgb(var(--color-border));
}
.login-page .recover-link {
    margin-bottom: .5rem;
    display: block;
    padding: 0;
    font-size: 1em;
}
.login-page .form-success {
    font-size: 0.8em;
    margin-bottom: 1rem;
}
{% endstylesheet %}

{% schema %}
{
  "name": "Customer login",
  "settings": [

  ]
}
{% endschema %}

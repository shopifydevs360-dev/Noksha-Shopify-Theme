{% doc %}
  Renders a rich text block with an optional heading.

  Intended for use inside sections that support theme blocks, such as
  the custom section.

  @example
  {% content_for 'block', type: 'richtext', id: 'richtext' %}
{% enddoc %}

{% liquid
  assign wrapper_tag = block.settings.wrapper_tag
  assign heading_tag = block.settings.heading_tag
  assign text_alignment = block.settings.text_alignment
%}

<{{ wrapper_tag }}
  class="richtext-block {{ block.settings.text_style }}"
  style="--richtext-align: {{ text_alignment }}; --richtext-max-width: {{ block.settings.max_width }}rem;"
  {{ block.shopify_attributes }}
>
  {% if block.settings.heading != blank %}
    <{{ heading_tag }} class="richtext-block__heading">
      {{ block.settings.heading | escape }}
    </{{ heading_tag }}>
  {% endif %}

  {% if block.settings.text != blank %}
    <div class="richtext-block__text">
      {{ block.settings.text }}
    </div>
  {% endif %}
</{{ wrapper_tag }}>

{% stylesheet %}
  .richtext-block {
    text-align: var(--richtext-align);
    max-width: var(--richtext-max-width);
    margin-inline: auto;
  }

  .richtext-block__heading {
    margin: 0 0 0.5em;
    font-weight: 600;
  }

  .richtext-block__text {
    line-height: 1.6;
  }

  .richtext-block--large-heading .richtext-block__heading {
    font-size: 2rem;
  }

  .richtext-block--medium-heading .richtext-block__heading {
    font-size: 1.5rem;
  }

  .richtext-block--small-heading .richtext-block__heading {
    font-size: 1.125rem;
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Rich text",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading"
    },
    {
      "type": "select",
      "id": "heading_tag",
      "label": "Heading level",
      "options": [
        { "value": "h2", "label": "Heading 2" },
        { "value": "h3", "label": "Heading 3" },
        { "value": "h4", "label": "Heading 4" }
      ],
      "default": "h2"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "Text"
    },
    {
      "type": "select",
      "id": "text_style",
      "label": "Heading size",
      "options": [
        { "value": "richtext-block--large-heading", "label": "Large" },
        { "value": "richtext-block--medium-heading", "label": "Medium" },
        { "value": "richtext-block--small-heading", "label": "Small" }
      ],
      "default": "richtext-block--medium-heading"
    },
    {
      "type": "text_alignment",
      "id": "text_alignment",
      "label": "Text alignment",
      "default": "left"
    },
    {
      "type": "range",
      "id": "max_width",
      "label": "Max content width",
      "min": 20,
      "max": 80,
      "step": 2,
      "unit": "rem",
      "default": 50
    },
    {
      "type": "select",
      "id": "wrapper_tag",
      "label": "Wrapper HTML tag",
      "options": [
        { "value": "section", "label": "Section" },
        { "value": "div", "label": "Div" },
        { "value": "article", "label": "Article" }
      ],
      "default": "div"
    }
  ],
  "presets": [
    {
      "name": "Rich text"
    }
  ]
}
{% endschema %}
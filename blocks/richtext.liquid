{% doc %}
  Renders a rich text block with an optional heading.

  Intended for use inside sections that support theme blocks, such as
  the custom section.

  @example
  {% content_for 'block', type: 'richtext', id: 'richtext' %}
{% enddoc %}

{% liquid
  assign wrapper_tag = block.settings.wrapper_tag
  assign heading_tag = block.settings.heading_tag
  assign text_alignment = block.settings.text_alignment
%}

<{{ wrapper_tag }}
  class="richtext-block {{ block.settings.text_style }}"
  style="--richtext-align: {{ text_alignment }}; --richtext-max-width: {{ block.settings.max_width }}rem;"
  {{ block.shopify_attributes }}
>
  {% if block.settings.heading != blank %}
    <{{ heading_tag }} class="richtext-block__heading">
      {{ block.settings.heading | escape }}
    </{{ heading_tag }}>
  {% endif %}

  {% if block.settings.text != blank %}
    <div class="richtext-block__text">
      {{ block.settings.text }}
    </div>
  {% endif %}
</{{ wrapper_tag }}>

{% stylesheet %}
  .richtext-block {
    text-align: var(--richtext-align);
    max-width: var(--richtext-max-width);
    margin-inline: auto;
  }

  .richtext-block__heading {
    margin: 0 0 0.5em;
    font-weight: 600;
  }

  .richtext-block__text {
    line-height: 1.6;
  }

  .richtext-block--large-heading .richtext-block__heading {
    font-size: 2rem;
  }

  .richtext-block--medium-heading .richtext-block__heading {
    font-size: 1.5rem;
  }

  .richtext-block--small-heading .richtext-block__heading {
    font-size: 1.125rem;
  }
{% endstylesheet %}

{% schema %}
{
  "name": "t:blocks.richtext.name",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "t:blocks.richtext.settings.heading.label"
    },
    {
      "type": "select",
      "id": "heading_tag",
      "label": "t:blocks.richtext.settings.heading_tag.label",
      "options": [
        { "value": "h2", "label": "t:blocks.richtext.settings.heading_tag.options.h2" },
        { "value": "h3", "label": "t:blocks.richtext.settings.heading_tag.options.h3" },
        { "value": "h4", "label": "t:blocks.richtext.settings.heading_tag.options.h4" }
      ],
      "default": "h2"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "t:blocks.richtext.settings.text.label"
    },
    {
      "type": "select",
      "id": "text_style",
      "label": "t:blocks.richtext.settings.text_style.label",
      "options": [
        { "value": "richtext-block--large-heading", "label": "t:blocks.richtext.settings.text_style.options.large" },
        { "value": "richtext-block--medium-heading", "label": "t:blocks.richtext.settings.text_style.options.medium" },
        { "value": "richtext-block--small-heading", "label": "t:blocks.richtext.settings.text_style.options.small" }
      ],
      "default": "richtext-block--medium-heading"
    },
    {
      "type": "text_alignment",
      "id": "text_alignment",
      "label": "t:blocks.richtext.settings.text_alignment.label",
      "default": "left"
    },
    {
      "type": "range",
      "id": "max_width",
      "label": "t:blocks.richtext.settings.max_width.label",
      "min": 20,
      "max": 80,
      "step": 2,
      "unit": "rem",
      "default": 50
    },
    {
      "type": "select",
      "id": "wrapper_tag",
      "label": "t:blocks.richtext.settings.wrapper_tag.label",
      "options": [
        { "value": "section", "label": "t:blocks.richtext.settings.wrapper_tag.options.section" },
        { "value": "div", "label": "t:blocks.richtext.settings.wrapper_tag.options.div" },
        { "value": "article", "label": "t:blocks.richtext.settings.wrapper_tag.options.article" }
      ],
      "default": "div"
    }
  ],
  "presets": [
    {
      "name": "t:blocks.richtext.presets.default.name"
    }
  ]
}
{% endschema %}